---
title: CDN
id: 6
---

### 因特网视频

视频：固定速度显示的图像序列

网络视频特点

- 高码率：>10x于音频，高的网络带宽需求
- 可以被压缩
- 90%以上的网络流量是视频

数字化图像：像素的阵列

- 每个像素被若干bits表示

编码：使用图像内和图像间的冗余来降低编码的比特数

- 空间冗余（图像内）
- 时间冗余（相邻的图像间）

编码方式

- CBR（constant bit  rate）：以固定速率编码
- VBR（variable bit  rate）：视频编码速率随时间的变化而变化





### 多媒体流化服务：DASH

DASH（HTTP的动态适应性流）: Dynamic, Adaptive Streaming over HTTP

服务器

- 将视频文件分割成多个块
- 每个块独立存储，编码于不同码率（8-10种）
- 告示文件（manifest file）: 提供不同块的URL

客户端

- 先获取告示文件
- 周期性地测量服务器到客户端的带宽
- 查询告示文件,在一个时刻请求一个块，HTTP头部指定字节范围
- 如果带宽足够，选择最大码率的视频块
- 会话中的不同时刻，可以切换请求不同的编码块 (取决于当时的可用带宽) 

智能客户端：客户端自适应决定

- 什么时候去请求块 (不至于缓存挨饿，或者溢出)
- 请求什么编码速率的视频块 (当带宽够用时，请求高质量的视频块)
- 哪里去请求块 (可以向离自己近的服务器发送URL，或者向高可用带宽的服务器请求) 



### 内容分发网（CDN）

CDN：Content Distribution Networks

服务器如何通过网络向上百万用户同时流化视频内容 (上百万视频内容)?

通过CDN，全网部署缓存节点，存储服务内容，就近为用户提供服务，提高用户体验

- enter deep：将CDN服务器深入到许多接入网
  - 更接近用户，数量多，离用户近，高度分布式设计管理困难
  - 如Akamai, 1700个位置
- bring home：部署在少数(10个左右)关键位置，如将服务器簇安装于POP附近（离若干1stISP POP较近）
  - 采用租用线路将服务器簇连接起来
  - Limelight

用户从CDN中请求内容

- 通过DNS重定向到最近的拷贝，请求内容
- 如果网络路径拥塞，可能选择不同的拷贝



**集群选择策略**：动态的将客户定向到CDN中的某个服务器集群或数据中心的机制